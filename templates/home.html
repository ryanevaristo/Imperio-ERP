{% extends 'base-home.html' %}
{% block 'title' %}Home{% endblock %}
{% load static %}
{% block 'head' %}
<link rel="stylesheet" href="{% static 'core/css/home.css' %}">
<link href="{% static 'core/css/charts.css' %}" rel="stylesheet" />
{% endblock %}

{% block 'body' %}


<h2 class="page-title">Dashboard</h2>
<div class="container-fluid" id="container" >
    <h2>links de acesso</h2>
    <p>acesso rapido para cada categoria.</p>
    <div id="linha">
        <div class="group">
            <h2 class="box-title">Comercial</h2>
            <div id="linha">
                <a class="btn btn-app" href="" id="button">
                    <i class="bi bi-box-seam" id="icone"></i>Produtos (em breve)
                </a>  
                <a class="btn btn-app" href="" id="button">
                    <i class="bi bi-cart fill" id="icone"></i>Vendas
                </a>
                <a class="btn btn-app" href="" id="button">
                    <i class="bi bi-bag-fill" id="icone"></i>PDV (em breve)
                </a>
            </div>
        </div>

        

        <div class="group">
            <h2 class="box-title">Financeiro</h2>

            <div id="linha">
                <a class="btn btn-app" href="{% url 'financeiro:despesas' %}" id="button">
                    <i class="bi bi-cash-stack" id="icone"></i>Despesas
                </a>
                <a class="btn btn-app" href="{% url 'financeiro:cheques' %}" id="button">
                    <i class="bi bi-cassette" id="icone"></i>Cheques
                </a>
                <a class="btn btn-app" href="{% url 'financeiro:entradas' %}" id="button">
                    <i class="
                    bi bi-currency-dollar" id="icone"></i>Entradas
                    
                </a>
                
            </div>
        </div>

        <div class="group">
            <h2 class="box-title">Usuários</h2>
            <div id="linha">
                
                <a class="btn btn-app" id="button">
                    <i class="bi bi-people-fill" id="icone"></i>Clientes  (em construção)
                </a>
                <a class="btn btn-app" href="{% url 'usuarios:vendedores' %}" id="button">
                    <i class="bi bi-person-fill" id="icone"></i>Vendedores
                </a>
                <a class="btn btn-app" href="" id="button">
                    <i class="bi bi-truck-front-fill" id="icone"></i>Fornecedores (em breve)
                </a>
                
            </div>
        </div>
        
    </div>
</div>

<div class="row">
    <div class="col-md-8" >
        <div class="box box-primary" id="container-charts">
            <div class="box-header">
                <h3 class="box-title">Gráfico de Vendas Mensal (Em construção)</h3>
            </div>
            <div class="box-body">
                <div>
                    <canvas id="myChart2" style="max-height: 400px;"></canvas>

                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script>
                    var ctx = document.getElementById('myChart2').getContext('2d');
                    var myChart2 = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                            datasets: [{
                                label: 'Teste',
                                data: [12, 19, 3, 5, 2, 3],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.8)',
                                    'rgba(54, 162, 235, 0.8)',
                                    'rgba(255, 206, 86, 0.8)',
                                    'rgba(75, 192, 192, 0.8)',
                                    'rgba(153, 102, 255, 0.8)',
                                    'rgba(255, 159, 64, 0.8)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                </script>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="box box-primary"  id="container-charts">
            <div class="box-header">
                <h3 id="titulo_chart2" class="box-title">Principais despesas</h3>
            </div>
            <div class="box-body" style="display: flex; justify-content: center;">
                <canvas id="myChart" ></canvas>

                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script>
                    var ctx = document.getElementById('myChart').getContext('2d');
                    var myChart = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                            datasets: [{
                                
                                data: [],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.8)',
                                    'rgba(54, 162, 235, 0.8)',
                                    'rgba(255, 206, 86, 0.8)',
                                    'rgba(75, 192, 192, 0.8)',
                                    'rgba(153, 102, 255, 0.8)',
                                    'rgba(255, 159, 64, 0.8)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true
                                }
                            }
                            
                        }
                    });
                </script>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block 'scripts' %}
<script>
    $.ajax({
        url: "{% url 'financeiro:total_despesas' %}",
        method: 'GET',
        success: function(response) {
            // transformar objeto em map 
            var despesas = Object.entries(response['total_despesas']);
            var mes_atual = response['mes_atual'];
            console.log(mes_atual);
            valores = [];
            labels = [];
            despesas.forEach(element => {
                valores.push(element[1]);
                labels.push(element[0]);
            });
            myChart.data.datasets[0].data = valores;
            myChart.data.labels = labels;
            
            myChart.update();
            if (mes_atual == 1) {
                mes_atual = 'Janeiro';
            } else if (mes_atual == 2) {
                mes_atual = 'Fevereiro';
            } else if (mes_atual == 3) {
                mes_atual = 'Março';
            } else if (mes_atual == 4) {
                mes_atual = 'Abril';
            } else if (mes_atual == 5) {
                mes_atual = 'Maio';
            } else if (mes_atual == 6) {
                mes_atual = 'Junho';
            } else if (mes_atual == 7) {
                mes_atual = 'Julho';
            } else if (mes_atual == 8) {
                mes_atual = 'Agosto';
            } else if (mes_atual == 9) {
                mes_atual = 'Setembro';
            } else if (mes_atual == 10) {
                mes_atual = 'Outubro';
            } else if (mes_atual == 11) {
                mes_atual = 'Novembro';
            } else if (mes_atual == 12) {
                mes_atual = 'Dezembro';
            }
            document.getElementById('titulo_chart2').innerHTML = 'Principais despesas em ' + mes_atual;
            // myChart.data.datasets[0].data = response['total_despesas'][];
        },
        error: function(error) {
            // Handle the error here
        }
    });
</script>

{% endblock %}




<!-- <a class="btn btn-app" href="{% url 'financeiro:financeiro' %}" id="button">
    <i class="bi bi-currency-dollar" id="icone"></i>Financeiro
</a>  
<a class="btn btn-app" href="" id="button">
    <i class="bi bi-table" id="icone"></i>Relatorios
</a>   -->